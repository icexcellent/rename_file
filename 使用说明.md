# 智能文件重命名工具 - 详细使用说明

## 📖 目录
1. [应用概述](#应用概述)
2. [安装配置](#安装配置)
3. [基本操作](#基本操作)
4. [高级功能](#高级功能)
5. [配置详解](#配置详解)
6. [常见问题](#常见问题)
7. [故障排除](#故障排除)

## 🎯 应用概述

智能文件重命名工具是专门为私募基金运维人员设计的桌面应用，能够：

- **智能识别文件内容**：自动提取文件中的关键信息
- **AI驱动重命名**：使用DeepSeek API提供智能分析
- **金融文档优化**：专门针对基金文档进行优化
- **批量处理**：支持大量文件同时处理
- **安全可靠**：支持操作回滚和错误处理

### 适用场景
- 私募基金文档整理
- 客户资料分类管理
- 业务凭证标准化命名
- 金融文档归档

## 🔧 安装配置

### 系统要求
- **操作系统**：macOS 10.14+ 或 Windows 10+
- **Python版本**：3.8 或更高版本
- **内存**：建议 4GB 以上
- **存储空间**：至少 500MB 可用空间

### 安装步骤

#### 1. 环境准备
```bash
# 创建项目目录
mkdir file_renamer_project
cd file_renamer_project

# 创建虚拟环境
python -m venv .venv

# 激活虚拟环境
# macOS/Linux:
source .venv/bin/activate
# Windows:
.venv\Scripts\activate
```

#### 2. 安装依赖
```bash
# 安装基础依赖
pip install -r requirements.txt

# 安装GUI依赖
pip install -r requirements_gui.txt
```

#### 3. 验证安装
```bash
# 运行应用
python file_renamer_gui.py
```

## 🚀 基本操作

### 1. 启动应用
双击 `file_renamer_gui.py` 或在终端运行：
```bash
python file_renamer_gui.py
```

### 2. 选择文件
1. 点击"📂 选择文件或文件夹"按钮
2. 在弹出的对话框中选择：
   - **单个文件**：选择具体的文件
   - **文件夹**：选择包含多个文件的文件夹
3. 点击"确定"完成选择

### 3. 设置目标目录
1. 在"选择目标目录"输入框中输入路径
2. 或点击"选择目录"按钮浏览选择
3. 这是重命名后文件的存储位置

### 4. 选择存储模式
- **复制模式**（推荐）：
  - 保留原文件不变
  - 重命名后的文件存储到目标目录
  - 更安全，可以随时回滚

- **覆盖模式**：
  - 直接重命名原文件
  - 节省存储空间
  - 操作不可逆，需谨慎使用

### 5. 开始重命名
1. 点击"开始重命名"按钮
2. 观察进度条和日志信息
3. 等待处理完成

## 🔍 高级功能

### 1. 内容识别技术

#### 图片文件识别
- **OCR技术**：使用pytesseract进行文字识别
- **支持格式**：jpg, png, gif, bmp等
- **识别内容**：文字、数字、符号等

#### PDF文件识别
- **文本提取**：使用pypdf和pdfplumber
- **扫描版PDF**：支持OCR识别
- **结构化信息**：表格、列表等

#### 文档文件识别
- **Word文档**：docx格式解析
- **文本文件**：txt格式读取
- **编码检测**：自动识别文件编码

### 2. AI增强功能

#### DeepSeek API集成
- **智能分析**：AI驱动的文档理解
- **内容提取**：自动识别关键信息
- **命名优化**：生成有意义的文件名

#### 金融文档优化
- **基金名称识别**：自动提取基金名称
- **客户信息提取**：识别客户姓名、联系方式
- **文档类型分类**：打款凭证、基本信息表等
- **日期格式化**：统一日期格式

### 3. 重命名示例

**原始文件**：`IMG_001.jpg`
**识别内容**：展弘多策略3号私募证券投资基金，客户：仇健鸣，文档类型：打款凭证，日期：2024-01-25
**重命名结果**：`展弘多策略3号私募证券投资基金-仇健鸣-打款凭证-2024-01-25.jpg`

**原始文件**：`document.pdf`
**识别内容**：某投资管理有限公司，客户：张三，文档类型：基本信息表，日期：2024年1月25日
**重命名结果**：`某投资管理有限公司-张三-基本信息表-2024年1月25日.pdf`

## ⚙️ 配置详解

### 1. DeepSeek API配置

#### 获取API密钥
1. 访问 [DeepSeek平台](https://platform.deepseek.com/)
2. 注册并登录账户
3. 进入"API管理"页面
4. 点击"创建API密钥"
5. 复制生成的密钥

#### 配置API密钥
1. 打开应用，进入"配置选项"标签页
2. 在"DeepSeek API配置"区域输入API密钥
3. 点击"测试API"验证配置
4. 点击"保存配置"保存设置

#### API密钥安全
- 不要分享给他人
- 定期更换密钥
- 监控API使用量

### 2. 重命名规则配置

#### 文本提取长度
- **默认值**：120字符
- **作用**：限制从文件中提取的文本长度
- **建议**：根据文件类型调整

#### 文件名最大长度
- **默认值**：60字符
- **作用**：限制重命名后文件名的长度
- **建议**：考虑文件系统限制

#### 格式转换选项
- **转换为小写**：统一文件名大小写
- **空格转换为下划线**：提高文件名兼容性

### 3. 文件类型过滤

#### 图片文件
- **支持格式**：jpg, jpeg, png, gif, bmp, tiff
- **识别方式**：OCR文字识别
- **适用场景**：扫描文档、截图等

#### PDF文件
- **支持格式**：pdf
- **识别方式**：文本提取 + OCR
- **适用场景**：电子文档、扫描版PDF

#### 文档文件
- **支持格式**：docx, doc, txt, rtf
- **识别方式**：文本解析
- **适用场景**：Word文档、文本文件

## ❓ 常见问题

### Q1: 为什么某些文件无法识别内容？
**A**: 可能的原因：
- 文件格式不支持
- 文件损坏或加密
- 扫描质量较差
- 文字语言不支持

**解决方案**：
- 检查文件格式是否在支持列表中
- 尝试使用DeepSeek API增强识别
- 提高扫描质量或重新扫描

### Q2: API密钥配置失败怎么办？
**A**: 检查以下项目：
- API密钥是否正确复制
- 网络连接是否正常
- API密钥是否有效
- 账户余额是否充足

### Q3: 重命名后的文件名不理想？
**A**: 可以尝试：
- 调整文本提取长度
- 修改文件名最大长度
- 配置DeepSeek API获得更好效果
- 检查重命名规则设置

### Q4: 如何处理大量文件？
**A**: 建议：
- 分批处理，避免内存不足
- 使用复制模式，确保数据安全
- 定期保存配置和日志
- 监控系统资源使用

### Q5: 如何回滚重命名操作？
**A**: 操作步骤：
1. 进入"执行结果"标签页
2. 查看重命名日志
3. 点击"回滚操作"按钮
4. 确认回滚操作
5. 等待回滚完成

## 🔧 故障排除

### 1. 应用无法启动

#### 问题现象
- 双击无反应
- 终端报错
- 界面显示异常

#### 解决方案
```bash
# 检查Python版本
python --version

# 检查依赖安装
pip list

# 重新安装依赖
pip install -r requirements.txt
pip install -r requirements_gui.txt

# 检查虚拟环境
source .venv/bin/activate
```

### 2. 文件识别失败

#### 问题现象
- 识别结果为空
- 识别内容不准确
- 处理速度很慢

#### 解决方案
- 检查文件格式和编码
- 验证API密钥配置
- 调整识别参数
- 检查网络连接

### 3. 界面显示异常

#### 问题现象
- 按钮无响应
- 布局错乱
- 文字显示异常

#### 解决方案
- 重启应用
- 检查系统分辨率
- 更新显卡驱动
- 重新安装PyQt6

### 4. 性能问题

#### 问题现象
- 处理速度慢
- 内存占用高
- 系统卡顿

#### 解决方案
- 减少同时处理的文件数量
- 关闭其他占用资源的程序
- 增加系统内存
- 使用SSD存储

## 📞 技术支持

### 获取帮助
- **文档**：查看README.md和本使用说明
- **日志**：检查应用日志文件
- **社区**：在项目Issues中提问

### 反馈建议
- 功能建议
- 问题报告
- 使用体验反馈

---

**版本**：1.0.0  
**更新日期**：2024年12月  
**技术支持**：项目维护团队
