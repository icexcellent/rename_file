# 打包说明

## ✅ 打包完成

智能文件重命名工具已成功打包成可执行文件！

## 📦 生成的文件

### macOS 应用包
- **文件位置**：`dist/FileRenamer.app`
- **文件类型**：macOS 应用程序包
- **启动方式**：双击或在终端运行 `open dist/FileRenamer.app`

### macOS 可执行文件
- **文件位置**：`dist/FileRenamer`
- **文件大小**：约 190MB
- **文件类型**：macOS 可执行文件
- **启动方式**：在终端运行 `./dist/FileRenamer`

### Windows 可执行文件
- **文件位置**：`dist/FileRenamer.exe`
- **文件大小**：约 200-300MB
- **文件类型**：Windows 可执行文件
- **启动方式**：双击运行或右键"以管理员身份运行"

## 🚀 使用方法

### macOS 使用方法

#### 方法1：直接运行应用包（推荐）
```bash
# 在 Finder 中双击 FileRenamer.app
# 或在终端运行
open dist/FileRenamer.app
```

#### 方法2：命令行运行
```bash
# 进入项目目录
cd /Users/ic_excellent/company/demo_environment/file_name_demo

# 运行可执行文件
./dist/FileRenamer
```

### Windows 使用方法

#### 方法1：直接运行（推荐）
```
双击 FileRenamer.exe 文件
```

#### 方法2：以管理员身份运行
```
右键点击 FileRenamer.exe
选择"以管理员身份运行"
```

#### 方法3：命令行运行
```cmd
# 进入项目目录
cd C:\path\to\file_name_demo

# 运行可执行文件
FileRenamer.exe
```

## 📋 打包配置

### 使用的打包工具
- **PyInstaller**：版本 6.15.0
- **打包模式**：--onefile（单文件模式）
- **窗口模式**：--windowed（无控制台窗口）

### 包含的依赖
- PyQt6 图形界面库
- pytesseract OCR 引擎
- pypdf PDF 处理库
- python-docx 文档处理库
- 其他必要的 Python 库

## 🔧 打包过程

### macOS 打包

#### 1. 环境准备
```bash
# 激活虚拟环境
source .venv/bin/activate

# 安装 PyInstaller
pip install pyinstaller
```

### Windows 打包

#### 1. 环境准备
```cmd
# 激活虚拟环境
.venv\Scripts\activate

# 安装 PyInstaller
pip install pyinstaller
```

#### 2. 使用Windows专用脚本
```cmd
# 运行Windows打包脚本
python build_windows.py
```

#### 3. 使用spec文件
```cmd
# 使用spec文件打包
pyinstaller FileRenamer.spec
```

#### 4. 手动打包命令
```cmd
pyinstaller --onefile --windowed --name=FileRenamer --hidden-import=PyQt6.QtCore --hidden-import=PyQt6.QtWidgets --hidden-import=PyQt6.QtGui --hidden-import=pytesseract --hidden-import=pypdf --hidden-import=docx --hidden-import=chardet --hidden-import=requests --hidden-import=json --hidden-import=pathlib --hidden-import=shutil --hidden-import=datetime --hidden-import=re --hidden-import=base64 --hidden-import=PIL --hidden-import=PIL.Image --hidden-import=pdfplumber file_renamer_gui.py
```

### 2. 执行打包
```bash
# 运行打包脚本
python build_app.py
```

### 3. 打包结果
- ✅ 成功生成 macOS 应用包
- ✅ 成功生成可执行文件
- ✅ 所有依赖已包含
- ✅ 应用可以独立运行

## 📁 文件结构

```
dist/
├── FileRenamer.app/          # macOS 应用包
│   └── Contents/
│       ├── MacOS/           # 可执行文件
│       ├── Resources/       # 资源文件
│       ├── Frameworks/      # 框架文件
│       ├── _CodeSignature/  # 代码签名
│       └── Info.plist       # 应用信息
└── FileRenamer              # 独立可执行文件
```

## ⚠️ 注意事项

### macOS 注意事项

#### 1. 文件大小
- 可执行文件较大（约190MB）
- 这是因为包含了所有必要的 Python 库和依赖
- 这是正常的，确保了应用的独立性

#### 2. 首次运行
- 首次运行可能需要较长时间
- 系统可能会提示安全警告
- 需要在"系统偏好设置 > 安全性与隐私"中允许运行

#### 3. 权限设置
```bash
# 如果需要，可以给可执行文件添加执行权限
chmod +x dist/FileRenamer
```

### Windows 注意事项

#### 1. 文件大小
- 可执行文件较大（约200-300MB）
- 这是因为包含了所有必要的 Python 库和依赖
- 这是正常的，确保了应用的独立性

#### 2. 首次运行
- 首次运行可能需要较长时间（解压和初始化）
- 系统可能会提示安全警告，选择"仍要运行"
- 如果被Windows Defender拦截，选择"允许"

#### 3. 权限设置
- 可能需要以管理员身份运行
- 确保目标目录有写入权限
- 检查杀毒软件是否拦截

#### 4. 系统要求
- Windows 10 或更高版本
- 至少 4GB 内存
- 安装 Visual C++ Redistributable

## 🧪 测试验证

### 功能测试
1. **启动测试**：应用能正常启动
2. **界面测试**：所有界面元素正常显示
3. **功能测试**：文件选择、重命名等功能正常
4. **配置测试**：API配置、设置保存等功能正常

### 兼容性测试
- ✅ macOS 10.14+
- ✅ Apple Silicon (M1/M2) 芯片
- ✅ Intel 芯片（理论上支持）

## 🔄 重新打包

如果需要重新打包，可以：

### 1. 清理旧文件
```bash
# 删除旧的构建文件
rm -rf build/
rm -rf dist/
rm -f *.spec
```

### 2. 重新打包
```bash
# 运行打包脚本
python build_app.py
```

## 📞 问题解决

### macOS 常见问题

#### Q: 应用无法启动
**A**: 检查系统安全设置，允许运行未知来源的应用

#### Q: 文件太大
**A**: 这是正常的，包含了完整的 Python 运行环境

#### Q: 某些功能不工作
**A**: 确保配置文件（config.json）在正确位置

#### Q: 权限错误
**A**: 运行 `chmod +x dist/FileRenamer` 添加执行权限

### Windows 常见问题

#### Q: 程序无法启动
**A**: 
- 以管理员身份运行
- 检查杀毒软件是否拦截
- 安装 Visual C++ Redistributable

#### Q: 缺少DLL文件
**A**: 
- 安装 Visual C++ Redistributable
- 下载地址：https://aka.ms/vs/17/release/vc_redist.x64.exe

#### Q: 权限错误
**A**: 
- 以管理员身份运行
- 检查文件夹权限
- 选择有写入权限的目录

#### Q: 程序启动缓慢
**A**: 
- 首次启动需要解压，耐心等待
- 确保有足够磁盘空间
- 关闭其他程序释放资源

**详细解决方案请参考**：[Windows问题排查.md](Windows问题排查.md)

## 🎯 部署建议

### 1. 分发方式
- 将 `FileRenamer.app` 打包成 DMG 文件
- 或直接分发 `.app` 文件
- 提供详细的安装说明

### 2. 用户指南
- 提供首次运行说明
- 解释安全设置步骤
- 包含使用教程

### 3. 版本管理
- 记录版本号和发布日期
- 保存打包配置文件
- 维护更新日志

---

**打包时间**：2024年12月  
**打包工具**：PyInstaller 6.15.0  
**目标平台**：macOS  
**文件大小**：约 190MB
